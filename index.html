<!DOCTYPE html>
<html>
<head>
    <title>Library System</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-100 p-6">

<h1 class="text-4xl font-bold mb-6 text-blue-600">ðŸ“š Library Manager</h1>

<div class="mb-4">
    <button onclick="showLogin()" class="bg-blue-500 text-white px-4 py-2 rounded">Developer Mode</button>
    <button onclick="switchToUser()" class="bg-green-500 text-white px-4 py-2 rounded">User Mode</button>
</div>

<!-- USER VIEW -->
<div id="userUI" class="bg-white p-6 rounded shadow">
    <h2 class="text-2xl font-bold mb-4">User Mode</h2>
    <input id="searchUser" class="border p-2 w-full" placeholder="Search books..." onkeyup="renderBooks()">

    <div id="bookList" class="mt-4"></div>
</div>

<!-- DEVELOPER VIEW -->
<div id="devUI" class="hidden bg-white p-6 rounded shadow">
    <h2 class="text-2xl font-bold mb-4 text-red-600">Developer Mode</h2>

    <!-- Add Book -->
    <div class="mb-6">
        <h3 class="font-bold text-lg mb-2">Add Book</h3>
        <input id="bookName" class="border p-2 w-full mb-2" placeholder="Book name">
        <select id="bookShelf" class="border p-2 w-full mb-2"></select>
        <button onclick="addBook()" class="bg-blue-600 text-white px-4 py-2 rounded">Add</button>
    </div>

    <!-- Delete Book -->
    <div class="mb-6">
        <h3 class="font-bold text-lg mb-2">Delete Book</h3>
        <select id="deleteBook" class="border p-2 w-full mb-2"></select>
        <button onclick="deleteBook()" class="bg-red-600 text-white px-4 py-2 rounded">Delete</button>
    </div>

    <!-- Move Book -->
    <div class="mb-6">
        <h3 class="font-bold text-lg mb-2">Move Book</h3>
        <select id="moveBook" class="border p-2 w-full mb-2"></select>
        <select id="moveShelf" class="border p-2 w-full mb-2"></select>
        <button onclick="moveBook()" class="bg-yellow-600 text-white px-4 py-2 rounded">Move</button>
    </div>

    <!-- Add Shelf -->
    <div class="mb-6">
        <h3 class="font-bold text-lg mb-2">Add Shelf</h3>
        <input id="newShelf" class="border p-2 w-full mb-2" placeholder="Shelf name">
        <button onclick="addShelf()" class="bg-purple-600 text-white px-4 py-2 rounded">Add</button>
    </div>

    <button onclick="logoutDev()" class="bg-gray-700 text-white px-4 py-2 rounded">Logout</button>
</div>

<!-- LOGIN POPUP -->
<div id="loginBox" class="hidden fixed top-1/3 left-1/2 transform -translate-x-1/2 bg-white p-6 shadow-xl rounded w-72">
    <h3 class="font-bold mb-2">Developer Login</h3>
    <input id="devPassword" type="password" class="border p-2 w-full mb-2" placeholder="Enter password">
    <button onclick="loginDev()" class="bg-blue-500 text-white px-4 py-2 rounded w-full">Login</button>
    <button onclick="hideLogin()" class="bg-red-500 text-white px-4 py-2 rounded w-full mt-2">Cancel</button>
</div>

<script src="script.js"></script>
</body>
</html>}

/*--------------------------------------------------
    DEV PANEL LOGIC
---------------------------------------------------*/
function refreshDevUI() {
    updateShelfDropdowns();
    updateBookLists();
    renderDevBooks();
}

function updateShelfDropdowns() {
    let shelfSelects = [document.getElementById("bookShelf"), document.getElementById("moveBookShelf")];
    shelfSelects.forEach(sel => {
        sel.innerHTML = "";
        shelves.forEach(s => {
            sel.innerHTML += `<option value="${s}">${s}</option>`;
        });
    });
}

function updateBookLists() {
    let delSel = document.getElementById("deleteBookList");
    let moveSel = document.getElementById("moveBookList");

    delSel.innerHTML = "";
    moveSel.innerHTML = "";

    books.forEach((b, i) => {
        delSel.innerHTML += `<option value="${i}">${b.name}</option>`;
        moveSel.innerHTML += `<option value="${i}">${b.name}</option>`;
    });
}

/*--------------------------------------------------
    BOOK OPERATIONS
---------------------------------------------------*/
function addBook() {
    let name = document.getElementById("bookName").value;
    let shelf = document.getElementById("bookShelf").value;

    if (!name) return alert("Enter book name");

    books.push({ name, shelf });
    alert("Book added!");
    refreshDevUI();
}

function deleteBook() {
    let index = document.getElementById("deleteBookList").value;
    books.splice(index, 1);
    alert("Book deleted!");
    refreshDevUI();
}

function moveBook() {
    let index = document.getElementById("moveBookList").value;
    let newShelf = document.getElementById("moveBookShelf").value;

    books[index].shelf = newShelf;
    alert("Book moved!");
    refreshDevUI();
}

function addShelf() {
    let name = document.getElementById("newShelfName").value;
    if (!name) return alert("Enter shelf name");

    shelves.push(name);
    alert("Shelf added!");
    refreshDevUI();
}

/*--------------------------------------------------
    TABLE RENDERING
---------------------------------------------------*/
function renderDevBooks() {
    let table = document.getElementById("devBookTable");
    table.innerHTML = `
        <tr><th>Book Name</th><th>Shelf</th></tr>
    `;
    books.forEach(b => {
        table.innerHTML += `<tr><td>${b.name}</td><td>${b.shelf}</td></tr>`;
    });
}

function renderUserBooks() {
    let table = document.getElementById("userBookTable");
    let search = document.getElementById("searchUser").value.toLowerCase();

    table.innerHTML = `<tr><th>Name</th><th>Shelf</th></tr>`;

    books.filter(b => b.name.toLowerCase().includes(search))
         .forEach(b => {
        table.innerHTML += `<tr><td>${b.name}</td><td>${b.shelf}</td></tr>`;
    });
}

/* INITIAL LOAD */
renderUserBooks();
</script>

</body>
</html>
