<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Library â€“ User</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

<!-- Header -->
<header class="bg-blue-600 text-white p-4 shadow-md">
    <h1 class="text-3xl font-bold text-center">ðŸ“š Library Book Finder</h1>
</header>

<!-- Main Container -->
<div class="max-w-3xl mx-auto mt-6 p-4 bg-white shadow-lg rounded-xl">

    <!-- Search Box -->
    <div class="flex gap-2">
        <input id="searchBox" 
               class="w-full p-3 border rounded-lg"
               placeholder="Search book by title, author, ISBN, or barcodeâ€¦">
        <button id="searchBtn"
                class="bg-blue-600 text-white px-4 rounded-lg hover:bg-blue-700">
            Search
        </button>
    </div>

    <!-- Results -->
    <h2 class="mt-6 text-xl font-semibold">Results</h2>
    <ul id="results" class="mt-4 space-y-3"></ul>
</div>

<script>
// Fetch books from API
async function searchBooks() {
    const q = document.getElementById('searchBox').value;
    const res = await fetch(`/api/books?q=${encodeURIComponent(q)}`);
    const data = await res.json();
    const list = document.getElementById('results');

    list.innerHTML = data.map(book => `
        <li class="p-4 bg-gray-50 border rounded-lg">
            <p class="font-bold text-lg">${book.title || "Untitled Book"}</p>
            <p class="text-gray-700">${book.author || "Unknown Author"}</p>
            <p class="text-sm">Barcode: ${book.barcode}</p>
            <p class="text-sm">Status: <span class="font-semibold">${book.status}</span></p>
            <p class="text-sm">Shelf: ${book.shelf_code || "Not on shelf"}</p>
        </li>
    `).join('');
}

// Search button event
document.getElementById("searchBtn").onclick = searchBooks;

// WebSocket â€” live updates
const ws = new WebSocket(
    (location.protocol === 'https:' ? 'wss://' : 'ws://') + location.host
);
ws.onmessage = (msg) => {
    console.log("Live update:", msg.data);
};
</script>
</body>
</html>
